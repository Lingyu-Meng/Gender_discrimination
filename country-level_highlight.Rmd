---
title: "Do some countries lag behind in equal rights trends?"
author: "L.-Y. M."
date: "2024-03-17"
output: html_document
bibliography: references.bib
csl: apa.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction

Recently, @schaerer2023 reported that the gender discrimination of hiring decisions has been eliminated and even reversed. They performed a meta-analysis of 44 years, and recruited a “red team” [@lakens2020] to critique their work. I applaud for their rigorous work and the pursuit of best practices in science. However, as they mentioned, the heterogeneity of the true effects was extremely large (I^2^-statistic = 82.8%), implying that 82.8% of the total variance can be attributed to heterogeneity. The odd rate of discrimination, which is the ratio of the hiring rate of males to that of females, was 0.91 (95% confidence interval ranged from 0.86 to 0.97, z = -3.00, p =.003). But the 95% prediction interval is as wide as 0.49 to 1.70, which means that the true effect in a new study is expected to fall within this range with 95% probability. That is obvious from their Figure 4, which is pasted below.

![](original_fig_4.png "Main result of (Spisak et al., 2023)")

According to their data, the samples are biased towards the United States and Western Europe. They performed leave-one-out analysis, and examined the potential country-level confounders, like country’s gender inequality, country’s education level, GDP per capita, Human Development Index, and even culture [@muthukrishna2020]. However, I still wonder if there are some country-level confounders that they did not consider. Therefore, I would like to point out each country’s data to see if there are some country-level systematic biases.

![](original_fig_2.png "Sample distribution of (Schaerer et al., 2023)")

Thanks for their open science practice, I can access their data and code from [here](https://osf.io/pt4gn).

```{r, message=FALSE}
## Load packages
library(tidyverse)
library(cowplot)
## Load data
dat <- readxl::read_excel("Data.xlsx", sheet = "DATA")
```

# Plots

We will first calculate the mean odd rate of different countries or regions. Then we will highlight the countries or regions with the highest and lowest odd rates.

```{r calculate mean OR by country}
# Odd rate
dat <- dat %>%
  mutate(OR = MaleSucc * FemaleFail / (MaleFail * FemaleSucc),
         N  = MaleN + FemaleN)
# Mean odd rate by country
dat_country <- dat %>%
  group_by(DataCounty) %>%
  summarise(mean_OR = mean(OR, na.rm = TRUE),
            N = sum(N, na.rm = TRUE)) %>%
  arrange(mean_OR)
# fig_country_mean
fig_country_mean <- dat_country %>%
  ggplot(aes(x = reorder(DataCounty, mean_OR), y = mean_OR, fill = N)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "red", high = "blue") +
  labs(x = "Country", y = "Mean odd rate") +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
fig_country_mean
```

One can see that the mean odd rate of different countries or regions varies a lot. The countries with the highest odd rates are Cyprus, Peru, and the United Kingdom, while the countries with the lowest odd rates are the Brazil, the Jamaica, and the Finland. In addition, the United States and China are in the middle with most and second most samples, respectively.

```{r highlight countries}
colorset <- dat_country %>% 
  select(DataCounty)
# highlight cyprus
colorset$highlights <- "grey"
colorset$highlights[colorset$DataCounty == "Cyprus"] <- "red"
dat_cyprus <- left_join(dat, colorset, by = "DataCounty")
# visualize cyprus
fig_cyprus <- dat_cyprus %>%
  ggplot(aes(x = ApplicYearMost, y = OR, color = highlights, size = N)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme_cowplot() + 
  labs(title = "Highlight Cyprus", x = "Year", y = "Odd rate")
fig_cyprus
# highlight peru
colorset$highlights <- "grey"
colorset$highlights[colorset$DataCounty == "Peru"] <- "red"
dat_peru <- left_join(dat, colorset, by = "DataCounty")
# visualize peru
fig_peru <- dat_peru %>%
  ggplot(aes(x = ApplicYearMost, y = OR, color = highlights, size = N)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme_cowplot() +
  labs(title = "Highlight Peru", x = "Year", y = "Odd rate")
fig_peru
# highlight UK
colorset$highlights <- "grey"
colorset$highlights[colorset$DataCounty == "United Kingdom"] <- "red"
dat_uk <- left_join(dat, colorset, by = "DataCounty")
# visualize UK
fig_uk <- dat_uk %>%
  ggplot(aes(x = ApplicYearMost, y = OR, color = highlights, size = N)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme_cowplot() +
  labs(title = "Highlight UK", x = "Year", y = "Odd rate")
fig_uk
# highlight US
colorset$highlights <- "grey"
colorset$highlights[colorset$DataCounty == "United States"] <- "red"
dat_us <- left_join(dat, colorset, by = "DataCounty")
# visualize US
fig_us <- dat_us %>%
  ggplot(aes(x = ApplicYearMost, y = OR, color = highlights, size = N)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme_cowplot() +
  labs(title = "Highlight US", x = "Year", y = "Odd rate")
fig_us
# highlight CN
colorset$highlights <- "grey"
colorset$highlights[colorset$DataCounty == "China"] <- "red"
dat_cn <- left_join(dat, colorset, by = "DataCounty")
# visualize CN
fig_cn <- dat_cn %>%
  ggplot(aes(x = ApplicYearMost, y = OR, color = highlights, size = N)) +
  geom_point(alpha = 0.5) +
  geom_hline(yintercept = 1, linetype = "dashed", color = "black") +
  theme_cowplot() +
  labs(title = "Highlight China", x = "Year", y = "Odd rate")
fig_cn
```

to be continued...

# References
